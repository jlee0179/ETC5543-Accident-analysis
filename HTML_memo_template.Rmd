---
title: 'MVA Analysis for Transdev'
author: "Lynxx - Joyce"
date: "17/06/2021"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
---

```{css, echo=FALSE}
#header {
  border-left: 3px solid #486370;
  padding-left: 10px;
}

h1 {
  color: #486370;
  font-weight: 500;
  border-left: 3px solid #486370;
  padding-left: 10px;
  margin-top: 110px;
}

#header h1 {
  border: none;
  padding-left: 0;
}

h2 {
  color: #512D6D;
  font-weight: 600;
}

h3 {
  color: #512D6D;
  font-style: italic;
  font-weight: 600;
}

h4 {
  color: #512D6D;
  font-weight: 600;
}
```

```{r, echo=FALSE}

# LYNXX LOGO

# modify css chunk above for additional font/spacing modifications
# fix the URL path or modify to lead to your locally saved logo - the image will be embedded into the document

htmltools::img(src = knitr::image_uri("lynxx_logo.png"), 
               alt = 'Lynxx logo', 
               style = 'position:absolute; top:0; padding:20px; border-left: 3px solid #486370; max-width:20%;margin-top:25px')

```

```{r include=FALSE}
library(broom)
library(caret)
library(ggridges)
library(hrbrthemes)
library(kableExtra)
library(lubridate)
library(parsnip)
library(plotly)
library(randomForest)
library(randomForestExplainer)
library(rsample)
library(rstatix)
library(tidyverse)
```


# Executive Summary

This report aims to discover the linkages between motor vehicle accidents (MVA incidents) and other potential factors. The ultimate goal is to resolve the current safety concerns with the information obtained. The data allows the exploration of various features, including depots, gender, age, tenure, weather, time and drivers’ workload. Data visualisation enables the initial understanding of the trend and pattern between the features of interest and the occurrence of incidents. Further, statistical tests clarify whether the selected feature is of sufficient weight on the output. Instead of making predictions, the purpose of modeling here is to convey the latent effect on incidents. Integrating the findings with interpretation, several recommendations are raised for improving drivers’ and passengers’ safety.

Overall, the results for the chosen variables are unanimous, all of them are associated with the occurrence of incidents. Although depots have not been formally tested with statistical methods, we observe the difference in incidents by region. Crowded areas are known with higher driver incident rates. Albeit the discrepancy between gender is significant with the greater likelihood for male drivers to get into an incident, more details are to be discussed. Not many young drivers have been recorded with an incident. This is arguable when referring to their tenure with only a few trips driven, compared with other age groups. The eldest age group demonstrates the highest stability with fewer incidents. Temperature and precipitation are proven to affect incidents, yet the impact is not as apparent as expected. Time is highlighted in the analysis as more incidents are found during peak traffic hours. Finally, drivers’ workload with incidents are related at daytime and night, drivers are not suggested to take long shifts.


# Introduction

Public transport has been deemed the response to environmental pollution and road safety issues. The ideal picture is that the more people on public transport, the less the traffic volume and pollution, the better the road safety ([Mackie, 2008](https://bcmj.org/presidents-comment/benefits-riding-bus)). Indeed, it brings about a good balance on both problems with its widely witnessed benefits. For instance, the reform on traffic policy by only allowing buses and taxis for accessing some areas in Ljubljana, Slovenia, has substantially cut down 72% of Black Carbon pollution ([Titos, et al., 2015](https://doi.org/10.1016/j.atmosenv.2015.05.027)). Regarding safety, injuries due to accidents have reduced by 24% since the introduction of night buses in Israel ([Sadot, 2019](https://doi.org/10.1016/j.regsciurbeco.2018.11.009)). Looking from an external view, although it appears as a win-win solution, it is not. Internally, public transport is exposed to risks anywhere and anytime that could put itself in danger, thus cannot be neglected. Its high capacity of passengers suggests the heavier burden faced.

Statistics of bus accidents vary from research to research. A downward trend of fatalities caused by bus accidents emerges from 2009 to 2014, yet it is not enduring with a growth found afterward ([Samerei et al., 2021](https://doi.org/10.1016/j.jsr.2020.12.004)). On the other hand, statistics from [Hughes (2021)](https://www.statista.com/statistics/1076120/australia-bus-fatalities/) show a significant drop in the number of fatalities from 2017 to 2018, followed by a rise in 2019. This inconsistency might have resulted from the different data and analysis methods used, thus suggesting the need to conduct analyses with the data in hand. The decreased usage of buses in these two years, the times full of unknown, has intensified the importance of understanding the causes of accidents. Apart from passengers’ potential shift towards private vehicles to avoid the crowd in the bus, the public transport industry is anticipated to either grow or fall as the pandemic abates ([IBISWorld, 2020](https://www.ibisworld.com/au/industry/public-transport/1965/)). Therefore, it is crucial to examine the bus operation now to minimise safety concerns for the near future.

Numerous factors induce bus accidents. Researchers who have performed relevant analyses mainly focus on dimensions encompassing drivers, vehicles and environments. Drivers’ gender, age and behaviour are counted towards drivers’ characteristics and are frequently discussed with their driving performance. Vehicle-specific causes take into account factors, e.g. the age and type of vehicles, which could affect drivers’ control over the bus. Environments relate to external factors, e.g. speed limits, road design and lighting facilities, that could contribute to bus accidents. The extent to which these variables are analysed depends on the available information in the data, however, any additional, related ones found will be inspected.

This report surrounds the five proposed questions to uncover the risks carried by the identified factors through data manipulation. Initially, we assess the weights of the selected variables, depot, gender, age and drivers’ tenure, on the occurrences of MVA incidents (see appendix). Data visualisation produces the overview, which serves to depict the existing patterns. Multiple statistical tests are applied to see whether a difference within the groups of a certain variable would generate different results for incidents. Subsequently, visualisation facilitates in understanding the patterns of the MVA incidents in day and time order, e.g. day of the week, hour of the day and day/night. In this report, the weather condition is based on temperature and precipitation. Due to the possible bias for certain weather with more or less data, statistical tests help to determine its significance on MVA incidents. A random forest is built in the last question to judge the importance of different influencing factors to the incidents. It reveals linkages between variables and their impacts on the outcome. Finally, recommendations are made based on the analysis results.


# Literature Review

The promotion of public transportation, despite being a common vision among nations, still is encountering road safety issues with the growing bus accidents in some countries. In emerging countries, e.g. Nepal and India, drivers and driving behaviour had been the leading cause of accidents, followed by external factors and vehicle conditions ([Pearce & Maunder, 2000](http://transport-links.com/wp-content/uploads/2019/11/1_549_PA3574-.pdf)). Although as a developed country, investigations on the common factors mentioned above and the need to discover more relevant ones are necessary for Australia.

[Truong and Currie (2019)](https://doi.org/10.1016/j.aap.2019.105270) assess the effectiveness of riding public transportation as a means to overcome road safety issues. Transportation types are individually measured in terms of their relative impacts. The CAR model takes into account factors, e.g. the age of the population in the sampled area, the speed limits and more, to study the causation between the environment and crashes. The ultimate result proves buses to be the safest transportation. A percentage point increase in the proportion of riding buses could reduce 5.7. Further, factors relevant to buses - signalised intersections, public transport stops and roads with speed limits above 100km/h are positively associated with crashes.

[Samerei, et al. (2021)](https://doi.org/10.1016/j.jsr.2020.12.004) follow up to consider the relevant factors’ relationship with the fatality due to bus accidents in Australia. Clustering analysis and association rules are applied respectively so that simultaneous or conditional events of factors can be revealed. From the clustering analysis, the largest proportion of total crashes are occupied by collisions with motor vehicles on weekdays (55%). Weekends are of great danger, accumulating the most fatality and serious injury, compared with other clusters. From the analysis of association rules, on weekdays, roads with speed limits over 50 are more likely to have bus collisions with motor vehicles than those without. Old, male drivers are associated with a 1.98 increase in cases except colliding with motor vehicles on weekdays. On weekends, the existence of pedestrians on highways is of high risk with 15.35 times of fatality increase. Additionally, darkness is more likely to incur the fatality of bus accidents in Australia.

In contrast, from a preventive perspective, [Porcu, et al. (2019)](https://doi.org/10.1016/j.trpro.2020.03.037) establish a risk index methodology to examine bus safety in Cagliari, Italy. The probability, severity of bus accidents and exposing factors are incorporated into the risk assessment index. Unlike [Truong and Currie (2019)](https://doi.org/10.1016/j.aap.2019.105270), relevant variables are not explicitly specified in the function, however are categorised under six broad factors: infrastructure, driver, vehicle, etc. Based on model selection, it draws to the conclusion that in Cagliari, medium, short sized buses traveling on roads with two to three lanes with bus priority are conditions that could result in a low-risk index. Different from the results in Australia ([Samerei et al., 2021](https://doi.org/10.1016/j.jsr.2020.12.004)), night is of less danger in Cagliari. On the opposite, drivers of standard-sized buses driving on roads with wide sidewalks and neighbourhood roads should be more aware as these factors tend to raise the risk level. Winter is also found to be more dangerous.

Unlike countries e.g. the US and the UK, the bus operation in Malaysia has not been well managed over years with the growing accidents in the intercity. [Law, et al. (2017)](https://doi.org/10.1016/j.tranpol.2017.05.003) adopt a similar idea as [Porcu et al. (2019)](https://doi.org/10.1016/j.trpro.2020.03.037) by creating Safety Performance Index (SPI) to evaluate the risk based on the attributable factors. Through the aggregation and classification of the factors, road environment condition accounts for the most detrimental cause of bus accidents. Two-lane roads, narrow road shoulders and nighttime trips are positively associated with the most risk. From the data exploration, using mobile phones when driving, drivers exceeding the speed limits and the low quality of tires are identified to be hazardous.

Bus priority policy is focused by [Goh, et al. (2014)](https://doi.org/10.1016/j.aap.2013.12.002) to discover the weight it has placed on resolving accidents in Melbourne. Prediction models are built with the potential factors as the inputs and the corresponding parameters. The better-performing model acknowledges bus priority as a useful approach in maintaining road safety with a reduction of 53.3% in accident frequency. Further, it reveals the tendency for accidents to occur more often as traffic volume, route length and service frequency increase. Again, it verifies the positive correlation between bus stop density and accident frequency, as found in [Truong and Currie (2019)](https://doi.org/10.1016/j.aap.2019.105270).

In brief, bus stop density and route length especially highways are the common factors addressed across Australian-based articles that require more attention in response to bus safety. From the different regions discussed, bus priority plays a significant role in reducing environmental inference for bus drivers. The effect of darkness varies between countries, yet is contributing towards bus accidents in Australia.


# Data

The data used in this report are obtained from Transdev, listed as follows:

* Driver_Info.csv
* Incidents.csv
* melbourneweather_20150101_20210428
* NSWshifts
* sydneyweather_20150101_20210415

`Driver_Info.csv` consists of the personal information with employment records for drivers across Melbourne, New South Wales (NSW), Queensland and Western Australia (WA). It is the main source for analysing drivers’ characteristics with its inclusion of variables, `Depot`, `Gender`, `Age` and `Tenure`. When modeling for significance testing, they are treated as the explanatory variables individually.

`Incidents.csv` records every incident across NSW, Melbourne and WA. It is the most widely used data set throughout the entire analysis. Observations are narrowed down to those in which the `ClaimCategoryName` include “MVA” and “motor” so the majority of outputs align with our analysis interest - MVA incidents. For the three interactive plots, incidents are classified according to their severity (see appendix). `Incidents.csv` often joins with other data sets by forming connections with relevant variables, such as depot, shift times and weather, to assess to what extent the variables are correlated. Incidents are often converted into a binomial form, e.g. whether an incident occurred on a specified hour, thus being regarded as the response variable.

`melbourneweather_20150101_20210428.csv` and `sydneyweather_20150101_20210415` are the weather-based data for Melbourne and Sydney. The hourly measured precipitation (mm) and temperature (°C) form the key for the weather. Despite being positioned as the response variable for statistical tests in section 4, it is not interpreted as whether the occurrence of incidents determines the rainfall. Rather, it summarises the association between rainfall and incidents.

`NSWshifts.csv` contains the bus shift information for Sydney. 30 minutes buffer time is added before and after the shift starting and ending times as some incidents occurred just right before or after the shifts. A lot of shifts are noted with very short timeframes. Therefore, we aggregate the shift starting and ending times daily for each driver for clearer analyses. The starting and ending times are very useful for the random forest. Drivers’ driving hour is derived by joining with `Incidents.csv` to examine drivers’ workload regarding the probability of incidents.

```{r include=FALSE}
driver_info <- read_csv("data/Driver_Info.csv") %>%
  filter(!Depot == "Not Given")
incidents <- read_csv("data/Incidents.csv")
nswshifts <- read_csv("data/NSWshifts.csv") %>%
  distinct()
melbourneweather <- read_csv("data/melbourneweather_20150101_20210428.csv")
sydneyweather <- read_csv("data/sydneyweather_20150101_20210415.csv")
```

```{r include=FALSE}
incidents <- incidents %>%
  unite(EmployeeID, c("company", "EmployeeNumber"), remove = FALSE)
```

```{r include=FALSE, message=FALSE}
nswshifts$VdsCompany <- toupper(nswshifts$VdsCompany)
nswshifts <- nswshifts %>%
  unite(EmployeeID, c("VdsCompany", "VdsEmployeeId"), remove = FALSE)


tmp <- incidents %>%
  filter(company == 'TDNSW') %>%
  select(ClaimNumber, EmployeeID, ClaimCategoryName, TypeOfClaimName, DateOccurred) %>%
  mutate(JoinDate = as.Date(DateOccurred)) %>%
  left_join(nswshifts %>%
              mutate(JoinDate = as.Date(VdsTripStartTime)),
            by = c("EmployeeID","JoinDate")) %>%
  mutate(match_type = case_when(
    is.na(VdsTripStartTime) ~ 0,
    DateOccurred >= VdsTripStartTime & DateOccurred <= VdsTripEndTime ~ 2,
    TRUE ~ 1
  ))
matched <-
  tmp %>%
  inner_join(
    tmp %>% group_by(ClaimNumber) %>% summarise(match_type = max(match_type)),
    by = c("ClaimNumber", "match_type")
  ) %>%
  arrange(match_type,ClaimNumber,VdsTripStartTime)

tmp2 <- incidents %>%
  filter(company == 'TDNSW') %>%
  select(ClaimNumber, EmployeeID, ClaimCategoryName, TypeOfClaimName,DateOccurred) %>%
  mutate(JoinDate = as.Date(DateOccurred)) %>%
  left_join(nswshifts %>%
              mutate(JoinDate = as.Date(VdsTripStartTime)) %>%
              group_by(EmployeeID, JoinDate) %>%
              summarise(shift_start = min(VdsTripStartTime)-30*60,
                        shift_end = max(VdsTripEndTime)+30*60),
            by = c("EmployeeID","JoinDate")) %>%
  mutate(match_type = case_when(
    is.na(shift_start) ~ 0,
    DateOccurred >= shift_start & DateOccurred <= shift_end ~ 2,
    TRUE ~ 1
  ))
matched <-
  tmp2 %>%
  inner_join(
    tmp2 %>% group_by(ClaimNumber) %>% summarise(match_type = max(match_type)),
    by = c("ClaimNumber", "match_type")
  ) %>%
  arrange(match_type,ClaimNumber,shift_start)

tmp <- tmp %>%
  mutate(day_of_week = weekdays(as.Date(DateOccurred)))

tmp2 <- tmp2 %>%
  mutate(day_of_week = weekdays(as.Date(DateOccurred)))
```

```{r include=FALSE}
melbourneweather <- melbourneweather %>%
  slice(-1:-9) %>%
  select(location, Melbourne, Melbourne_1) %>%
  rename(c(timestamp = location, `Melbourne Temperature` = Melbourne, `Melbourne Precipitation Total` = Melbourne_1)) 
melbourneweather <- melbourneweather %>%
        mutate(timestamp = ymd_hm(timestamp))

```

```{r include=FALSE}
sydneyweather <- sydneyweather %>%
  slice(-1:-9) %>%
  select(location, Sydney, Sydney_1) %>%
  rename(c(timestamp = location, `Sydney Temperature` = Sydney, `Sydney Precipitation Total` = Sydney_1)) 
sydneyweather <- sydneyweather %>%
        mutate(timestamp = ymd_hm(timestamp))
```

# 1) How are drivers' characteristics (Depot, gender and age) affecting the incidents? Do they genuinely contribute to the occurrence of incidents?

## Depot

```{r echo=FALSE, message=FALSE}
# all drivers in each depot
drvr_inc_dpt_mva <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes")) %>%
  group_by(Depot, CompanyID, driver_incident, EmployeeID) %>%
  summarise(driver_depot = n_distinct(EmployeeID)) %>%
  filter(driver_incident == "Yes") %>%
  group_by(Depot, CompanyID) %>%
  summarise(num_drv_inc = sum(driver_depot))

total_drvr_dpt <- driver_info %>%
  group_by(Depot, CompanyID) %>%
  summarise(num_of_drvr = n())

drvr_inc_dpt_mva %>%
  left_join(total_drvr_dpt, by = c("Depot", "CompanyID")) %>%
  mutate(has_incident_dpt = (num_drv_inc/num_of_drvr)*100) %>%
  mutate(across(has_incident_dpt, round, 2)) %>%
  ggplot(aes(x = Depot, y = has_incident_dpt, fill = CompanyID)) +
  geom_bar(stat = "identity") + 
  geom_text(aes(label = has_incident_dpt), vjust=1.6, color="white", size=2.5) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(y = "Drivers had claims", fill = "Company", title = "Proportion of Drivers Had MVA Claims by Depot")


```

All drivers are first grouped according to their corresponding depots. The proportion is calculated by the number of drivers that have MVA incidents divided by total drivers in each depot.

Out of 23 depots, only 4 don't have an incident. Drivers of depots located in NSW and Melbourne have recorded more than half the MVA accidents. Revesby and Taren Point in NSW are the depots with the highest driver incident rates. Despite that NSW has the most depots with incidents, drivers with depots in Melbourne are involved with the most incidents. Doncaster, North-Fitzroy, Sunshine West and Thomastown are noted with the most danger. 

The discrepancy exists between states, the driver incident rates for depots in WA are much lower, compared with NSW and Melbourne. This may lie in the population differences. Even though a very small portion of drivers in WA had incidents, still, 75% of drivers in Joondalup depot have encountered MVA incidents.

```{r echo=FALSE, message=FALSE}
severity_inc <- incidents %>%
  mutate(severity = case_when(TypeOfClaimName %in% c("MVA - Hit by Third Party", "MVA - Hit parked vehicle", "Customer Injury- Heavy Braking", "MVA - Hit moving vehicle while driving straight", "MVA - Hit moving vehicle while turning", "MVA - Hit stationary vehicle while turning", "MVA - Hit stationary vehicle driving straight", "MVA - Hit illegally parked vehicle", "MVA - Hit moving vehicle while changing lanes", "Pedestrian Injury - Hit by Transdev vehicle", "MVA - Hit bus station", "Employee Injury - Motor Vehicle Accident", "Motor Vehicle Collision", "Collision with Public") ~ "serious",
                              TypeOfClaimName %in% c("MVA - Hit tree/ tree branch", "MVA - Hit barrier/ bollard", "MVA - Near Miss", "MVA - Reversing", "MVA bus stop sign", "MVA bus stop pole") ~ "slight")) %>%
  filter(severity %in% c("serious", "slight"))

inc_severity_dept <- severity_inc %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes")) %>%
  group_by(Depot, CompanyID, driver_incident, EmployeeID, severity) %>%
  summarise(driver_depot = n_distinct(EmployeeID)) %>%
  filter(driver_incident == "Yes") %>%
  group_by(Depot, severity, CompanyID) %>%
  summarise(num_drv_inc = sum(driver_depot))
  
total_drvr_dpt <- driver_info %>%
  group_by(Depot, CompanyID) %>%
  summarise(num_of_drvr = n())

svr_dpt <- inc_severity_dept %>%
  left_join(total_drvr_dpt, by = c("Depot", "CompanyID")) %>%
  mutate(has_incident_dpt = (num_drv_inc/num_of_drvr)*100) %>%
  mutate(across(has_incident_dpt, round, 2)) %>%
  pivot_wider(names_from = severity, values_from = has_incident_dpt) %>%
  mutate(serious = replace_na(serious, 0),
         slight = replace_na(slight, 0))

svr_dpt %>%
  mutate(serious_label = paste0(CompanyID," - Serious"),
         slight_label = paste0(CompanyID," - Slight")) %>%
  plot_ly(x = ~Depot, color = ~CompanyID) %>%
  add_trace(y = ~serious, name = ~serious_label, type='bar',width = 0.3) %>%
  add_trace(y = ~slight, name = ~slight_label, type='bar', width=0.3,opacity=0.5) %>%
  layout(
    title = "Proportion of Drivers Had MVA Claims by Depot and Severity",
    yaxis = list(title = "Drivers had claims (%)",
                 range=c(0,100)),
    updatemenus = list(
      list(
        type = "buttons",
        #label = 'Category',
        buttons = list(
          list(method = "restyle",
               args = list('visible', c(rep(TRUE,3), rep(FALSE,3))),
               label = "Serious Only"),
          list(method = "restyle",
               args = list('visible', c(rep(FALSE,3), rep(TRUE,3))),
               label = "Slight Only"),
          list(method = "restyle",
               args = list('visible', TRUE),
               label = "Show All")
        )
      )
    )
  )
```

To evaluate the relationship between the accident severity in different depots and the driver incident rates, we divided them into “serious” and “slight” according to incident types. The results for serious incidents are pretty close to the MVAs with a smaller scale. Narrowing down to slight incidents, only a few depots in NSW and one in WA appear. Again, the driver incident rates for Revesby and Taren Point depots had exceeded 50% for slight incidents. The comparison with the previous graph implies that the majority of MVA incidents drivers encountered in Melbourne and WA depots are serious.

## Gender

```{r echo=FALSE, message=FALSE}
drvr_inc_gdr_mva <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes")) %>%
  group_by(Gender, CompanyID, driver_incident, EmployeeID) %>%
  summarise(driver_gdr = n_distinct(EmployeeID)) %>%
  filter(driver_incident == "Yes") %>%
  group_by(Gender, CompanyID) %>%
  summarise(num_drv_inc = sum(driver_gdr))

total_drvr_gdr <- driver_info %>%
  group_by(Gender, CompanyID) %>%
  summarise(num_of_drvr = n())

drvr_inc_gdr_mva %>%
  full_join(total_drvr_gdr, by = c("Gender", "CompanyID")) %>%
  mutate(num_drv_inc = replace_na(num_drv_inc, 0)) %>%
  mutate(has_incident_gdr = (num_drv_inc/num_of_drvr)*100) %>%
  mutate(across(has_incident_gdr, round, 2)) %>%
  ggplot(aes(x = Gender, y = has_incident_gdr, fill = Gender)) +
  geom_bar(stat = "identity") + 
  geom_text(aes(label = has_incident_gdr), vjust=1.6, color="white", size=2.5) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme_minimal() +
  facet_grid(.~CompanyID) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(y = "Drivers had claims", fill = "Gender", title = "Proportion of Drivers Had Claims by Gender and Company")
  
```

The absence number for Queensland is due to the lack of data in the data set. Gender differences exist in the data. In NSW and Melbourne, drivers’ gender ratio is around 10 to 15 males per female, while approximately 6 in WA. Although male drivers’ incident rates exceed the females in the three states, the numbers are only of slight differences. The ratio of MVA incidents between genders is nearly 1:1. Briefly, female drivers' incident rate is unexpectedly high.

```{r echo=FALSE, message=FALSE}
inc_severity_gdr <- severity_inc %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes")) %>%
  group_by(Gender, CompanyID, driver_incident, EmployeeID, severity) %>%
  summarise(driver_depot = n_distinct(EmployeeID)) %>%
  filter(driver_incident == "Yes") %>%
  group_by(Gender, severity, CompanyID) %>%
  summarise(num_drv_inc = sum(driver_depot))
  
total_drvr_gdr <- driver_info %>%
  group_by(Gender, CompanyID) %>%
  summarise(num_of_drvr = n())

svr_gdr <- inc_severity_gdr %>%
  left_join(total_drvr_gdr, by = c("Gender", "CompanyID")) %>%
  mutate(has_incident_gdr = (num_drv_inc/num_of_drvr)*100) %>%
  mutate(across(has_incident_gdr, round, 2)) %>%
  pivot_wider(names_from = severity, values_from = has_incident_gdr) %>%
  mutate(serious = replace_na(serious, 0),
         slight = replace_na(slight, 0))

svr_gdr %>%
  mutate(serious_label = paste0(CompanyID," - Serious"),
         slight_label = paste0(CompanyID," - Slight")) %>%
  plot_ly(x = ~Gender, color = ~CompanyID) %>%
  add_trace(y = ~serious, name = ~serious_label, type='bar') %>%
  add_trace(y = ~slight, name = ~slight_label, type='bar',opacity=0.5)  %>%
  layout(
    yaxis = list(title = "Drivers had claims (%)",
      range=c(0,100)
    ),
    title = "Proportion of Drivers Had Claims by Gender, Company & Severity",
    updatemenus = list(
      list(
        type = "buttons",
        label = 'Category',
        buttons = list(
          list(method = "restyle",
               args = list('visible', c(rep(TRUE,3), rep(FALSE,3))),
               label = "Serious Only"),
          list(method = "restyle",
               args = list('visible', c(rep(FALSE,3), rep(TRUE,3))),
               label = "Slight Only"),
          list(method = "restyle",
               args = list('visible', TRUE),
               label = "Show All")
        )
      )
    )
  )
```

Classified with incident severity, the figure presents similar results to the MVAs. Both male and female drivers in NSW and males in WA contribute towards slight incidents.

Male driver’s incident rate is higher than females by 19%. The graphs above also suggest male drivers had been exposed to more incidents. Due to the imbalance number in drivers’ gender, it could be unfair to conclude merely from the frequency distribution, two-sample t-test comes into place to determine if our assumption is based on random chance.

```{r echo=FALSE, message=FALSE}
gen_inc <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes")) %>%
  group_by(Gender, driver_incident, EmployeeID) %>%
  summarise(driver_depot = n_distinct(EmployeeID)) %>%
  group_by(Gender, driver_incident) %>%
  summarise(num_drv_inc = sum(driver_depot))

tot_drv_gen <- driver_info %>%
  distinct(EmployeeID, Gender) %>%
  group_by(Gender) %>%
  summarise(num_of_drvr = n())

gen_inc_tab <- gen_inc %>%
  pivot_wider(names_from = driver_incident, values_from = num_drv_inc) %>%
  left_join(tot_drv_gen, by = "Gender") %>%
  mutate(has_incident_gdr = (Yes/num_of_drvr)*100) %>%
  mutate(across(has_incident_gdr, round, 2)) %>%
  rename(incident = Yes, `no incident` = No, total = num_of_drvr, prop = has_incident_gdr) 
gen_inc_tab %>%
  kable(caption = "Contingency Table for Gender and Incident") %>%
  kable_styling()

```

$H_0: \text{Gender and incidents are independent. There is no relationship between them.}$
$H_1: \text{Gender and incidents are dependent. Male drivers are more likely to encounter incidents than females.}$

The p-value of 0 allows us to reject the null hypothesis and confirms gender’s impact on incidents. Male drivers are indeed more likely to have incidents.

```{r echo=FALSE}
test_x <- as.matrix(gen_inc_tab %>%
                      ungroup() %>%
                      select(incident, `no incident`))
CLTest_gen <- prop.test(test_x)
tidy(CLTest_gen) %>%
  kable(caption = "Two-Sample t-Test Results for Gender") %>%
  kable_styling(bootstrap_options = "striped")
```

## Age

```{r echo=FALSE, message=FALSE}
inc_age_mva <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_age = today() - dmy(BirthDate),
         driver_age = driver_age/dyears(),
         driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes"))
inc_age_mva$driver_age <- round(inc_age_mva$driver_age, digits = 0)
inc_age_mva <- inc_age_mva %>%
  mutate(age_group = case_when(driver_age >= 20 & driver_age <= 30 ~ "20-30",
                               driver_age >= 31 & driver_age <= 40 ~ "31-40",
                               driver_age >= 41 & driver_age <= 50 ~ "41-50",
                               driver_age >= 51 & driver_age <= 60 ~ "51-60",
                               driver_age >= 61 & driver_age <= 70 ~ "61-70",
                               driver_age >= 71 & driver_age <= 80 ~ "71-80",
                               driver_age >= 81 & driver_age <= 90 ~ "81-90"))
inc_age_mva <- inc_age_mva %>%
  group_by(age_group, driver_incident, EmployeeID) %>%
  summarise(driver_age_group = n_distinct(EmployeeID)) %>%
  filter(driver_incident == "Yes") %>%
  group_by(age_group) %>%
  summarise(num_drv_inc = sum(driver_age_group))


drvr_info_age <- driver_info %>%
  mutate(driver_age = today() - dmy(BirthDate),
         driver_age = driver_age/dyears())
drvr_info_age$driver_age <- round(drvr_info_age$driver_age, digits = 0)
drvr_info_age <- drvr_info_age %>%
  mutate(age_group = case_when(driver_age >= 20 & driver_age <= 30 ~ "20-30",
                               driver_age >= 31 & driver_age <= 40 ~ "31-40",
                               driver_age >= 41 & driver_age <= 50 ~ "41-50",
                               driver_age >= 51 & driver_age <= 60 ~ "51-60",
                               driver_age >= 61 & driver_age <= 70 ~ "61-70",
                               driver_age >= 71 & driver_age <= 80 ~ "71-80",
                               driver_age >= 81 & driver_age <= 90 ~ "81-90"))
drvr_info_age <- drvr_info_age %>%
  group_by(age_group) %>%
  summarise(num_of_drvr = n())

inc_age_mva %>%
  full_join(drvr_info_age, by = "age_group") %>%
  mutate(has_incident_age = (num_drv_inc/num_of_drvr)*100) %>%
  mutate(across(has_incident_age, round, 2)) %>%
  ggplot(aes(x = age_group, y = has_incident_age, fill = age_group)) +
  geom_bar(stat = "identity") + 
  geom_text(aes(label = has_incident_age), vjust=1.6, color="white", size=2.5) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(x = "Age group", y = "Drivers had claims", fill = "Age group", title = "Proportion of Drivers Had MVA Claims by Age")
```

All drivers are grouped by their corresponding age group. The plot presents that of the total drivers within each age group, the proportion of drivers having recorded MVA incidents. Neither the youngest nor the eldest drivers are the most dangerous. The 31-40 age group has the highest driver incident rate. As the age groups go up until 51-60, the number starts reducing.

```{r echo=FALSE, message=FALSE, warning=FALSE}
inc_severity_age <- severity_inc %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_age = today() - dmy(BirthDate),
         driver_age = driver_age/dyears(),
         driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes")) 

inc_severity_age$driver_age <- round(inc_severity_age$driver_age, digits = 0)
inc_severity_age <- inc_severity_age %>%
  mutate(age_group = case_when(driver_age >= 20 & driver_age <= 30 ~ "20-30",
                               driver_age >= 31 & driver_age <= 40 ~ "31-40",
                               driver_age >= 41 & driver_age <= 50 ~ "41-50",
                               driver_age >= 51 & driver_age <= 60 ~ "51-60",
                               driver_age >= 61 & driver_age <= 70 ~ "61-70",
                               driver_age >= 71 & driver_age <= 80 ~ "71-80",
                               driver_age >= 81 & driver_age <= 90 ~ "81-90"))

inc_severity_age <- inc_severity_age %>%
  group_by(age_group, driver_incident, EmployeeID, severity) %>%
  summarise(driver_age_group = n_distinct(EmployeeID)) %>%
  filter(driver_incident == "Yes") %>%
  group_by(age_group, severity) %>%
  summarise(num_drv_inc = sum(driver_age_group))
  
drvr_info_age <- driver_info %>%
  mutate(driver_age = today() - dmy(BirthDate),
         driver_age = driver_age/dyears())
drvr_info_age$driver_age <- round(drvr_info_age$driver_age, digits = 0)
drvr_info_age <- drvr_info_age %>%
  mutate(age_group = case_when(driver_age >= 20 & driver_age <= 30 ~ "20-30",
                               driver_age >= 31 & driver_age <= 40 ~ "31-40",
                               driver_age >= 41 & driver_age <= 50 ~ "41-50",
                               driver_age >= 51 & driver_age <= 60 ~ "51-60",
                               driver_age >= 61 & driver_age <= 70 ~ "61-70",
                               driver_age >= 71 & driver_age <= 80 ~ "71-80",
                               driver_age >= 81 & driver_age <= 90 ~ "81-90"))
drvr_info_age <- drvr_info_age %>%
  group_by(age_group) %>%
  summarise(num_of_drvr = n())

svr_age <- inc_severity_age %>%
  full_join(drvr_info_age, by = "age_group") %>%
  mutate(has_incident_age = (num_drv_inc/num_of_drvr)*100) %>%
  mutate(across(has_incident_age, round, 2)) %>%
  pivot_wider(names_from = severity, values_from = has_incident_age) %>%
  mutate(serious = replace_na(serious, 0),
         slight = replace_na(slight, 0))

plot_ly(svr_age, x = ~age_group, mode='markers') %>%
  add_trace(y = ~serious, name = 'serious', type='bar', mode='markers') %>%
  add_trace(y = ~slight, name = 'slight', type='bar', mode='markers') %>%
  layout(
    title = "Proportion of Drivers Had claims by Age Group and Severity",
    xaxis = list(title = "Age group"),
    yaxis = list(title = "Drivers had claims (%)",
                 range=c(0,100)),
    updatemenus = list(
      list(
        type = "buttons",
        label = 'Category',
        buttons = list(
          list(method = "restyle",
               args = list('visible', c(TRUE, FALSE, FALSE)),
               label = "Serious Only"),
          list(method = "restyle",
               args = list('visible', c(FALSE, TRUE, FALSE)),
               label = "Slight Only"),
          list(method = "restyle",
               args = list("visible", TRUE),
               label = "Show All")
        )
      )
    )
  )


```

The outcome for serious incidents is roughly the same as that for the MVAs, except on a lower scale. The driver incident rates for slight ones exhibit a left-skewed distribution, referring to the tendency towards the older age groups. The proportion grows until 61-70 as the peak, following a decline afterward. 



```{r include=FALSE}
age_mva_inc <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_age = today() - dmy(BirthDate),
         driver_age = driver_age/dyears(),
         driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes"))
age_mva_inc$driver_age <- round(age_mva_inc$driver_age, digits = 0)
age_mva_inc <- age_mva_inc %>%
  mutate(age_group = case_when(driver_age >= 20 & driver_age <= 30 ~ "20-30",
                               driver_age >= 31 & driver_age <= 40 ~ "31-40",
                               driver_age >= 41 & driver_age <= 50 ~ "41-50",
                               driver_age >= 51 & driver_age <= 60 ~ "51-60",
                               driver_age >= 61 & driver_age <= 70 ~ "61-70",
                               driver_age >= 71 & driver_age <= 80 ~ "71-80",
                               driver_age >= 81 & driver_age <= 90 ~ "81-90")) %>%
  group_by(age_group, driver_incident, EmployeeID) %>%
  summarise(driver_age_group = n_distinct(EmployeeID)) %>%
  group_by(age_group, driver_incident) %>%
  summarise(num_drvage_inc = sum(driver_age_group))

tot_drv_age <- driver_info %>%
  mutate(driver_age = today() - dmy(BirthDate),
         driver_age = driver_age/dyears())

tot_drv_age$driver_age <- round(tot_drv_age$driver_age, digits = 0)

tot_drv_age <- tot_drv_age %>%
  mutate(age_group = case_when(driver_age >= 20 & driver_age <= 30 ~ "20-30",
                               driver_age >= 31 & driver_age <= 40 ~ "31-40",
                               driver_age >= 41 & driver_age <= 50 ~ "41-50",
                               driver_age >= 51 & driver_age <= 60 ~ "51-60",
                               driver_age >= 61 & driver_age <= 70 ~ "61-70",
                               driver_age >= 71 & driver_age <= 80 ~ "71-80",
                               driver_age >= 81 & driver_age <= 90 ~ "81-90")) %>%
  distinct(EmployeeID, age_group) %>%
  group_by(age_group) %>%
  summarise(num_of_drvr = n())

age_inc_tab <- age_mva_inc %>%
  pivot_wider(names_from = driver_incident, values_from = num_drvage_inc) %>%
  left_join(tot_drv_age, by = "age_group") %>%
  mutate(has_incident_age = (Yes/num_of_drvr)*100) %>%
  mutate(across(has_incident_age, round, 2)) %>%
  rename(`age group` = age_group, incident = Yes, `no incident` = No, total = num_of_drvr, prop = has_incident_age) 

# ordinal e.g. 20-30, 41-50, 51-60, 61-70. Same contingency format
age_inc_tab %>%
  kable() %>%
  kable_styling()
```

From the graphs above, it is hard to determine the association between age and incidents as neither positive nor negative trend presents. ANOVA test takes the 20-30 age group as the baseline to allow comparisons with the means of other age groups. The p-values are small, confirming the significance of the 6 age groups and the association with incidents.

```{r echo=FALSE}
bin_age <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(driver_age = today() - dmy(BirthDate),
         driver_age = driver_age/dyears(),
         driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes"),
         driver_age = round(driver_age,digits=0),
         age_group = case_when(driver_age >= 20 & driver_age <= 30 ~ "20-30",
                               driver_age >= 31 & driver_age <= 40 ~ "31-40",
                               driver_age >= 41 & driver_age <= 50 ~ "41-50",
                               driver_age >= 51 & driver_age <= 60 ~ "51-60",
                               driver_age >= 61 & driver_age <= 70 ~ "61-70",
                               driver_age >= 71 & driver_age <= 80 ~ "71-80",
                               driver_age >= 81 & driver_age <= 90 ~ "81-90")) %>%
  mutate(binary_outcome = case_when(
    driver_incident == 'Yes' ~ 1,
    TRUE ~ 0
  ))

model_fit <- glm(binary_outcome ~ age_group, data=bin_age, family = "binomial") 
summary(model_fit)


```

## Tenure

Tenure is derived from the interval between an employee’s starting day and today in years, if the driver is currently in Transdev. For those who have quit, their tenure is the interval between the starting and the employment termination dates.

Based on the graph below, a positive trend exists, the driver incident rate grows with the increase in driving experiences. This might be misleading, when a driver takes more shifts, his or her exposure to the risks would increase. The result is not surprising that those with 41-60 years of experience had all been involved in incidents.


```{r echo=FALSE, message=FALSE}
inc_ten_mva <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(EmployeeStartDate = format(as.POSIXct(EmployeeStartDate, format = "%d/%m/%Y %H:%M") ,format='%d/%m/%Y'),
         driver_ten = case_when(is.na(EmploymentTerminationDate) ~ today() - dmy(EmployeeStartDate),
                                TRUE ~ dmy(EmploymentTerminationDate) - dmy(EmployeeStartDate)),
         driver_ten = driver_ten/dyears(),
         driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes"))
inc_ten_mva$driver_ten <- round(inc_ten_mva$driver_ten, digits = 0)
inc_ten_mva <- inc_ten_mva %>%
  mutate(ten_group = case_when(driver_ten >= 0 & driver_ten <= 5 ~ "0-5",
                                driver_ten >= 6 & driver_ten <= 10 ~ "6-10",
                               driver_ten >= 7 & driver_ten <= 10 ~ "7-10",
                               driver_ten >= 11 & driver_ten <= 20 ~ "11-20",
                               driver_ten >= 21 & driver_ten <= 30 ~ "21-30",
                               driver_ten >= 31 & driver_ten <= 40 ~ "31-40",
                               driver_ten >= 41 & driver_ten <= 50 ~ "41-50",
                               driver_ten >= 51 & driver_ten <= 60 ~ "51-60"))
inc_ten_mva$ten_group <- factor(inc_ten_mva$ten_group, 
   levels = c("0-5", "6-10", "11-20", "21-30", "31-40", "41-50", "51-60", "61-70"))

inc_ten_mva <- inc_ten_mva %>%
  group_by(ten_group, driver_incident, EmployeeID) %>%
  summarise(driver_ten_group = n_distinct(EmployeeID)) %>%
  filter(driver_incident == "Yes") %>%
  group_by(ten_group) %>%
  summarise(num_drv_inc = sum(driver_ten_group))


drvr_info_ten <- driver_info %>%
  mutate(EmployeeStartDate = format(as.POSIXct(EmployeeStartDate, format = "%d/%m/%Y %H:%M") ,format='%d/%m/%Y'),
         driver_ten = case_when(is.na(EmploymentTerminationDate) ~ today() - dmy(EmployeeStartDate),
                                TRUE ~ dmy(EmploymentTerminationDate) - dmy(EmployeeStartDate)),
         driver_ten = driver_ten/dyears())
drvr_info_ten$driver_ten <- round(drvr_info_ten$driver_ten, digits = 0)
drvr_info_ten <- drvr_info_ten %>%
  mutate(ten_group = case_when(driver_ten >= 0 & driver_ten <= 5 ~ "0-5",
                               driver_ten >= 6 & driver_ten <= 10 ~ "6-10",
                               driver_ten >= 11 & driver_ten <= 20 ~ "11-20",
                               driver_ten >= 21 & driver_ten <= 30 ~ "21-30",
                               driver_ten >= 31 & driver_ten <= 40 ~ "31-40",
                               driver_ten >= 41 & driver_ten <= 50 ~ "41-50",
                               driver_ten >= 51 & driver_ten <= 60 ~ "51-60",
                               driver_ten >= 61 & driver_ten <= 70 ~ "61-70"))
drvr_info_ten$ten_group <- factor(drvr_info_ten$ten_group, 
   levels = c("0-5", "6-10", "11-20", "21-30", "31-40", "41-50", "51-60", "61-70"))

drvr_info_ten <- drvr_info_ten %>%
  group_by(ten_group) %>%
  summarise(num_of_drvr = n())

inc_ten_mva %>%
  full_join(drvr_info_ten, by = "ten_group") %>%
  mutate(has_incident_ten = (num_drv_inc/num_of_drvr)*100) %>%
  mutate(across(has_incident_ten, round, 2)) %>%
  ggplot(aes(x = ten_group, y = has_incident_ten, fill = ten_group)) +
  geom_bar(stat = "identity") + 
  geom_text(aes(label = has_incident_ten), vjust=1.6, color="white", size=2.5) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(x = "Tenure group", y = "Drivers had claims", fill = "Tenure group", title = "Proportion of Drivers Had MVA Claims by Tenure")


```

The outcome overturns when breaking down the total employed years into yearly form, it records the specific year where a driver encounters incidents and aggregates them by years. The previous positive trend now becomes a positively skewed distribution where the tenure and incidents appear to be negatively correlated. Most incidents are recorded within drivers’ first three years of experience. Strictly speaking, the first ten years of drivers’ employment holds a great portion of incidents among the entire count which is worth to be discussed.

```{r echo=FALSE}
long_inc_ten <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  right_join(driver_info, by = "EmployeeID") %>%
  mutate(EmployeeStartDate = format(as.POSIXct(EmployeeStartDate, format = "%d/%m/%Y %H:%M") ,format='%Y'),
         EmploymentTerminationDate = format(as.POSIXct(EmploymentTerminationDate, format = "%d/%m/%Y") ,format='%Y'),
         Occurred_yr = year(DateOccurred),
         driver_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes"),
         EmploymentTerminationDate = replace_na(EmploymentTerminationDate, 2021),
         EmployeeStartDate = as.numeric(EmployeeStartDate),
         EmploymentTerminationDate = as.numeric(EmploymentTerminationDate)) %>%
 rowwise() %>%
  mutate(every_year_drive = list(c(EmployeeStartDate:EmploymentTerminationDate))) %>%
  unnest(cols = c(every_year_drive)) %>%
  mutate(num_tenure = every_year_drive - EmployeeStartDate) %>%
  mutate(incident_indicator = case_when(
    Occurred_yr == every_year_drive ~ 1,
    TRUE                               ~ 0
  )) 

long_inc_ten %>%
  filter(incident_indicator == 1) %>%
  ggplot(aes(x = num_tenure)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "grey80") +
  scale_x_continuous(breaks = round(seq(min(long_inc_ten$num_tenure), max(long_inc_ten$num_tenure), by = 5),1)) +
  theme_minimal() +
  labs(x = "The th of year", y = "Number of Incidents", title = "Drivers' Tenure - The th year Drivers Had MVA  Incidents since Employed")

```

Binomial logistic regression assists to verify the relationship observed in the graph above. Obtaining 0 for p-value suggests that tenure is a significant variable, which illustrates the dependency of incidents on tenure. The negative estimate infers that an increase in the years of experiences reduces the likelihood of running into an incident.

```{r echo=FALSE}
logistic_mod <- logistic_reg() %>% 
  set_engine("glm") %>% 
  set_mode("classification") %>%
  translate()

long_inc_ten <- long_inc_ten %>%
  mutate(incident_indicator = factor(incident_indicator))

ten_fit <- 
  logistic_mod %>% 
  fit(incident_indicator ~ num_tenure, 
      family = binomial(),
      data = long_inc_ten)

tidy(ten_fit) %>% kable(caption = "Binomial Logistic Regression Results for Tenure") %>% kable_styling(full_width = FALSE)
```

# 2) On what day have most incidents been found? Which hours are the peak and trough?

```{r echo=FALSE}
incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  mutate(day_week = weekdays(as.Date(DateOccurred))) %>%
  group_by(day_week) %>%
  summarise(total_cases = n()) %>%
  ggplot(aes(x = factor(day_week, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")), total_cases)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  geom_text(aes(label=total_cases), vjust=1.6, color="white", size=3.5)+
  theme_minimal() +
  labs(y = "Total claim number", x = "Day", title = "Total MVA Claim by Day of the Week")
```

Monday is the peak with the most incidents, whereas Sunday is the trough. The number of incidents that occurred on weekdays is more even and exceeds those on weekends by half. This can be linked to the heavy usage of private vehicles and public transport for commuting, together resulting in the busy traffic.

```{r echo=FALSE, message=FALSE}
incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  mutate(day_week = weekdays(DateOccurred),
         hour = hour(DateOccurred)) %>%
  group_by(day_week, hour) %>%
  summarise(total_cases = n()) %>%
  ggplot(aes(x = hour, y = total_cases)) +
  geom_line() +
  facet_wrap(~factor(day_week, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))) +
    theme_minimal() +
  labs(y = "Total claim number", x = "Hour", title = "Total MVA Claim by Hour of the Day")

```

The hourly graphs illustrate the earlier statement regarding peak traffic hours. 7-8 am and 3-5 pm incur the most incidents on weekdays. On weekends, the spike is around 3 pm. The variation in incident number has been much narrower on weekends. Nevertheless, a common point between weekdays and weekends is that incidents tend to reduce in the evening.

# 3) Is it more dangerous for the bus to travel at night or during the daytime?

```{r echo=FALSE}
daynight_incidents_mva <- incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  mutate(hour = hour(DateOccurred))

daynight_incidents_mva %>%
  mutate(day_night = case_when(hour >= 19 | hour %in% c(0, 1, 2, 3, 4) ~ "night",
                               hour < 19 ~ "day")) %>%
  group_by(day_night) %>%
  summarise(total_cases = n()) %>%
  ggplot(aes(x = day_night, y = total_cases, fill = day_night)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label=total_cases), vjust=1.6, color="white", size=3.5) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(x = "Daytime/night", y = "Total claim number", title = "Total MVA Claims during Daytime and Night")
```

The timeframe for daytime is from 5 am to before 7 pm, while the rest is nighttime. The number of incidents recorded during the daytime is roughly 9 times more than those at the night. However, this may be linked to the timetable of bus shifts.

# 4) What kind of weather (temperature and precipitation) is considered safer or dangerous for bus drivers?

## Rain

Light rain is defined with precipitation less than 2.5 mm ([Wikipedia, n.d.](https://en.wikipedia.org/wiki/Rain)), so is set as the baseline to distinguish between little/no rain and rain. The hourly rainfall distributions for Melbourne and NSW are plotted with and without MVA incidents. They share similar shapes with both peaks around 3 mm, which is not considered heavy rain. The downward-sloping curve for Melbourne isn’t as smooth as NSW. For Melbourne, incidents aggregate closely with 4.5 mm of precipitation. Additionally, its tail towards the right end is slightly higher than NSW. This reveals that heavy rain has more effects on incidents in Melbourne.

```{r echo=FALSE}
dh_mva_incidents <- incidents %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  mutate(date_hour = format(DateOccurred, format = "%Y-%m-%d %H")) %>%
  filter(company %in% c("TDNSW", "TDM"),
         grepl('MVA|Motor', ClaimCategoryName))

melbourneweather <- melbourneweather %>%
  mutate(company = "TDM",
         date_hour = format(timestamp, format = "%Y-%m-%d %H")) %>%
  rename(Temperature = `Melbourne Temperature`, Precipitation = `Melbourne Precipitation Total`)

sydneyweather <- sydneyweather %>%
  mutate(company = "TDNSW",
         date_hour = format(timestamp, format = "%Y-%m-%d %H")) %>%
  rename(Temperature = `Sydney Temperature`, Precipitation = `Sydney Precipitation Total`)

mel_syd_weather <- rbind(melbourneweather, sydneyweather)

weather_n_incidents <- mel_syd_weather %>%
  mutate(hour = hour(timestamp)) %>%
  left_join(dh_mva_incidents, by = c("company", "date_hour")) %>%
  mutate(Temperature = as.numeric(Temperature),
         Precipitation = as.numeric(Precipitation),
         rain = case_when(Precipitation >= 2.5 ~ "Yes",
                          Precipitation < 2.5 ~ "No"),
         has_incident = case_when(is.na(ClaimNumber) ~ "No",
                                         !is.na(ClaimNumber) ~ "Yes"))

weather_n_incidents %>%
  filter(rain == "Yes") %>%
  ggplot(aes(x = Precipitation, group = has_incident, fill = has_incident)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~company, nrow = 2) +
  theme_minimal() +
  theme(legend.title = element_blank()) +
  scale_fill_discrete(labels=c("Non-incident", "Incident")) +
  labs(x = "Rainfall (mm)", title = "Incident and Non-Incident Distribution under Rainy Condition Measured by Precipitation") +
  expand_limits(x = -0.5)
```

The distributions for Melbourne and NSW are approximately the same when there is little/no rain. The only difference observed is the taller peak for incidents in NSW, more incidents occurred in NSW under conditions with little/no rain.

```{r echo=FALSE}
weather_n_incidents %>%
  filter(rain == "No") %>%
  ggplot(aes(x = Precipitation, group = has_incident, fill = has_incident)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~company, nrow = 2) +
  theme_minimal() +
  theme(legend.title = element_blank()) +
  scale_fill_discrete(labels=c("Non-incident", "Incident")) +
  labs(x = "Rainfall (mm)", title = "Incident and Non-Incident Distribution under Little/No Rain Condition Measured by Precipitation") +
  expand_limits(x = -0.2:2.4)
```

The following outputs are the summary of precipitation with and without incidents, respectively. The overall distributions lean towards little/no rain in both cases, having 0s dominate the 6 numbers. The only two differences lie in the mean and maximum. The mean rainfall is slightly higher when incidents occur, however, the maximum is lower. It is not reasonable to say that incidents have an impact on precipitation, rather, we discover whether an association exists between them.

```{r echo=FALSE}
# compare precipitation between has_incident=yes and has_incident=no
rain_inc <- weather_n_incidents %>%
  select(Precipitation, has_incident) 
# has_incident = yes
summary(rain_inc %>%
          filter(has_incident == "Yes") %>%
          .$Precipitation) 

summary(rain_inc %>%
          filter(has_incident == "No") %>%
          .$Precipitation)
```

The non-normal precipitation distributions with and without incidents fail to meet the criteria for the t-test, even with the added log scale. 

```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplot(rain_inc, aes(Precipitation)) +
        geom_histogram(fill = "skyblue", color = "grey60") +
        facet_wrap(~has_incident) +
        scale_x_log10() +
  theme_minimal() +
  labs(title = "Log Distribution of Non-Incidents and Incidents by Precipitation")
```

$H_0: \text{The precipitation averages for incidents and non-incidents are the same.}$
$H_1: \text{The precipitation averages for incidents and non-incidents differ.}$

The nonparametric test corrects the continuity and confirms the effect of precipitation on incidents with a small p-value. 

```{r echo=FALSE}
wilcox.test(Precipitation ~ has_incident, data = rain_inc)
# is associated, relationship
```

## Temperature

Similarly, the hourly measured temperature is plotted in distributions with and without the occurrence of MVA incidents. The shapes of incidents follow closely after the non-incidents for both states where incidents are positioned towards the higher temperature. The peak of incidents is 15 degrees for Melbourne, whereas around 20 degrees for NSW. A large portion concentrates between 10 and 25 degrees in Melbourne and 15 to 25 degrees in NSW. Although on a smaller scale, the distribution for Melbourne is relatively right-skewed, compared with NSW. This indicates the common occurrence of incidents on hotter days in Melbourne.

```{r echo=FALSE}
weather_n_incidents %>%
  ggplot(aes(x = Temperature, group = has_incident, fill = has_incident)) +
  geom_density(alpha = 0.5) +
  facet_grid(~company) +
  theme_minimal() +
  theme(legend.title = element_blank()) +
  scale_fill_discrete(labels=c("Non-incident", "Incident")) +
  labs(x = "Temperature (°C)", title = "Incident and Non-Incident Distribution Measured by Temperature")

```

The summary outputs below explain the temperature distribution for conditions with and without incident occurrence. All values for incidents, except maximum, are larger than those for the non-incidents. It is not suitable to state that the temperature tends to be higher when incidents occur. Yet this is an initial observation that incidents are possibly associated with times of higher temperature.

```{r echo=FALSE}
temp_inc <- weather_n_incidents %>%
  select(Temperature, has_incident) 

summary(temp_inc %>%
          filter(has_incident == "Yes") %>%
          .$Temperature)

summary(temp_inc %>%
          filter(has_incident == "No") %>%
          .$Temperature)
```

Both temperature distributions for incidents and non-incidents seem approximately normally distributed, thus can be proceeded to two-sample t-test for significance testing.

```{r echo=FALSE, message=FALSE}
ggplot(temp_inc, aes(Temperature)) +
        geom_histogram(fill = "skyblue", color = "grey60") +
        facet_wrap(~has_incident) +
  theme_minimal() +
  labs(title = "Distribution of Non-incidents and Incidents by Temperature")
```

$H_0: \text{The temperature averages for incidents and non-incidents are equal.}$
$H_1: \text{The temperature averages for incidents and non-incidents differ.}$

The p-value from this test is again less than the threshold. Therefore, the null hypothesis is rejected, an association genuinely exists between temperature and incidents. Specifically, the “mean in group No” and “mean in group Yes” prove the statistical difference with a higher mean value for incidents.

```{r echo=FALSE}
t.test(Temperature ~ has_incident, data = temp_inc)
```

# 5) Is there a relationship between drivers' driving hours within a day and the likelihood of getting into an incident?

```{r echo=FALSE}
tmp2_when_occur <- tmp2 %>%
  filter(match_type == 2) %>%
  distinct(EmployeeID, ClaimCategoryName, DateOccurred, .keep_all = TRUE) %>%
  mutate(diff_occur_start = difftime(DateOccurred, shift_start),
         diff_occur_start = diff_occur_start/dhours(),
         hour = hour(DateOccurred),
         day_night = case_when(hour >= 19 | hour %in% c(0, 1, 2, 3, 4) ~ "Night",
                               hour < 19 ~ "Day")) %>%
  filter(grepl('MVA|Motor', ClaimCategoryName))
tmp2_when_occur$diff_occur_start <- round(tmp2_when_occur$diff_occur_start, digits = 0) 

ggplot(tmp2_when_occur, aes(x = diff_occur_start)) +
  geom_histogram(aes(y = ..density..), bins = 25, alpha = 0.4, fill = "skyblue", color = "grey80") +
  geom_density() +
  facet_grid(~day_night) +
  theme_minimal() +
  labs(x = "Number of hour(s) after shift start", title = "The Hour in which Claims Made since Drivers Start Driving within the Day")

```

The graph above plots the distribution of drivers’ driving hours against the hour they ran into MVA incidents. The trends and patterns are inconsistent from day to night time. During the daytime, a large portion of incidents occurred within the first 3 hours of driving which is the peak. Driving hours between 7 to 10 are also found to have accumulated many incidents. The pattern shifts to the later hours for nighttime, with 7 to 9 hours as the peak. Additionally, many incidents are recorded around 9 hours of day drives and 12 hours of night drives.

```{r echo=FALSE, message=FALSE}

nswshifts1 <- nswshifts %>%
  rename(shift_start = VdsTripStartTime, shift_end = VdsTripEndTime) %>%
  mutate(JoinDate = as.Date(shift_start)) %>%
  select(EmployeeID, shift_start, shift_end, JoinDate)

incident1 <- incidents %>%
  drop_na(EmployeeNumber) %>%
  distinct(EmployeeID, ClaimCategoryId, DateOccurred, .keep_all = TRUE) %>%
  filter(company == "TDNSW", grepl('MVA|Motor', ClaimCategoryName)) %>%
  mutate(JoinDate = as.Date(DateOccurred)) %>%
  group_by(EmployeeID, JoinDate) %>%
  select(EmployeeID, DateOccurred, JoinDate)

nswshifts_lj_inc <- nswshifts1 %>%
  group_by(EmployeeID, JoinDate) %>%
  summarise(shift_start = min(shift_start)-30*60,
            shift_end = max(shift_end)+30*60) %>%
  left_join(incident1, by = c("EmployeeID", "JoinDate")) %>%
  select(EmployeeID, shift_start, shift_end, DateOccurred) %>%
  mutate(has_incident = case_when(is.na(DateOccurred) ~ "No",
                                         !is.na(DateOccurred) ~ "Yes"))

long_shifts_inc <- nswshifts_lj_inc %>%
  mutate(shift_date = as.Date(shift_start),
         shift_start_hour = hour(shift_start),
         shift_end_hour = hour(shift_end),
         Occurred_hour = hour(DateOccurred)) %>% 
  mutate(shift_end_hour = case_when(shift_end_hour < shift_start_hour ~ 24+shift_end_hour,
                                    TRUE ~ as.numeric(shift_end_hour)),
         trip_duration = difftime(shift_end, shift_start),
         trip_duration = trip_duration/dhours()) %>%
  filter(trip_duration < 24,
         shift_start_hour < 22, shift_start_hour > 4) %>%

  rowwise() %>%
  mutate(shift_hour_of_day = list(c(shift_start_hour:shift_end_hour))) %>%
  unnest(cols = c(shift_hour_of_day)) %>%
  mutate(shift_hour_for_driver = shift_hour_of_day - shift_start_hour) %>%

  mutate(incident_indicator = case_when(
    Occurred_hour == shift_hour_of_day ~ 1,
    TRUE                               ~ 0
  )) %>%
  select(-shift_start, -shift_end, -DateOccurred, -Occurred_hour) 

sydneyweather_dh <- sydneyweather %>%
  mutate(date = as.Date(timestamp),
         hour = hour(timestamp),
         hour = case_when(hour == 0 ~ 24,
                          TRUE ~ as.numeric(hour)))

nsw_fit_df <- long_shifts_inc %>%
  left_join(sydneyweather_dh, by = c("shift_date" = "date", "shift_hour_of_day" = "hour")) %>%
  left_join(driver_info, by = "EmployeeID") %>%
  ungroup() %>%
  select(-EmployeeID, -has_incident, -shift_date, -shift_start_hour, -shift_end_hour, -trip_duration, -timestamp, -Depot, -CompanyID, -EmployeeStartDate, -EmploymentTerminationDate, -Position, -ContractType, -FTE, -BirthDate, -company, -date_hour) 
  
```

Drivers’ workload is represented by the number of hours they have been driving within a day. Drivers’ shifts dataset is expanded to a longer form so that each hour of driving can be noted. Further, variables measured hourly, e.g. temperature and precipitation, are suitable to be added to this new data set. Although the effects of temperature and precipitation on incidents have been verified earlier, they are now compared with other variables. Thus, a random forest is built to disclose the importance of the four features - hours of driving, the hour of the day, temperature and precipitation, to the occurrence of incidents.

The response variable of 0 indicates no incident recorded during the given driving hour in the day and time, while 1 stands for the occurrence of an incident. Due to the imbalance between incidents and non-incidents which could lead to biased prediction, up-sampling is implemented to replicate data for the minority class to minimise the discrepancy in the results.

```{r echo=FALSE}
set.seed(2021)

nsw_fit_df <- nsw_fit_df %>%
  na.omit() %>%
  mutate(incident_indicator = factor(incident_indicator)) 
nsw_fit_split <- initial_split(nsw_fit_df, 2/3,
                                         strata = incident_indicator)
nsw_fit_tr <- training(nsw_fit_split) %>% 
  mutate(Gender = factor(Gender)) %>% 
  mutate(Precipitation = as.numeric(Precipitation)) %>%
  mutate(Temperature = as.numeric(Temperature))
nsw_fit_ts <- testing(nsw_fit_split)

up_train <- upSample(x = nsw_fit_tr[, -ncol(nsw_fit_tr)],
                     y = nsw_fit_tr$incident_indicator)                         


nsw_fit_rf <- randomForest(incident_indicator ~ shift_hour_of_day+shift_hour_for_driver+Temperature+Precipitation, data = up_train, importance = TRUE)
print(nsw_fit_rf)


nsw_fit_ts_pred <- nsw_fit_ts %>%
  mutate(.pred = predict(nsw_fit_rf, nsw_fit_ts, type = "prob"))

importance(nsw_fit_rf)
```

Mean decrease accuracy assesses how much the model accuracy will decrease if that variable is dropped, while mean decrease Gini measures the variable importance based on Gini impurity index ([Bhalla, n.d.](https://www.listendata.com/2014/11/random-forest-with-r.html)). The outcomes are reversed for all features. Precipitation holds the greatest importance for mean decrease accuracy, yet it becomes the least important variable according to mean decrease Gini. On the opposite, temperature, albeit weighs the least for mean decrease accuracy, scores the highest importance for mean decrease Gini. The positions for the hour of the day and driver's driving hour also overturn.

```{r echo=FALSE}
varImpPlot(nsw_fit_rf)
```

We focus on the interactions between variables that are presumably relevant.

In the interaction plot for the time of the day and drivers' driving hours, some segments provide meaningful insights. The most apparent pattern that appears in the corner indicates the greater likelihood of incidents for drivers who had driven only for less than 5 hours from 5 to 10 am. In the afternoon, between 2 pm and 6 pm, drivers' who had driven for 7 hours or more within a day are noted with more dangers of being involved in an incident.

```{r echo=FALSE}
plot_predict_interaction(nsw_fit_rf, up_train, "shift_hour_of_day", "shift_hour_for_driver")
```

No clear pattern is shown in the interaction plot between temperature and precipitation, even though they are both associated with incidents.

```{r echo=FALSE}
plot_predict_interaction(nsw_fit_rf, up_train, "Temperature", "Precipitation")
```

# Discussion

Of the variables investigated in this analysis, all of them are associated with the occurrence of MVA incidents. Although depot has not proceeded to t-test, the gaps in between depots are displayed. Noteworthily, a large portion of total MVA incidents occurred in more populated states, NSW and Melbourne. This is foreseeable as much research conducted globally acknowledges the positive correlation between population and bus accidents ([Bentama, et al., 2017](https://doi.org/10.1109/LOGISTIQUA.2017.7962885)). The unexpectedly high driver incident rate in Joondalup seems odd. Due to the high number of drivers recorded with slight incidents, we assume drivers in NSW, especially Revesby and Taren Point, might have been driving with less care or have more exposure to hazards.

Despite the two-sample t-test expects male drivers to be more likely to encounter an incident, the graphs reveal the unproportionate difference in incidents between male and female drivers. This suggests that there might be other complex factors within female drivers which have drawn to this result.

To some extent, drivers’ age and tenure are related. An old driver is not necessarily experienced. The statement that the youngest driver group (20-30) has been driving more safely is only partially true. These drivers might have been new to Transdev with less than 10 years of experience in bus driving, which is noted with the high occurrence of incidents. We can be sure that elder drivers’ driving performance is stable due to the low driver incident rates with the increase in tenure. However, they should be mindful of slight incidents.

Driving at night is commonly assumed with higher exposure to drink-driving, night visibility and fatigue effects ([Keall, et al., 2005](https://doi.org/10.1016/j.aap.2005.03.021.)). It is also polarised based on the findings from the literature review. Our findings claim the high risks of driving in the daytime in NSW, especially during peak traffic hours. Even drivers who had only been driving for less than 5 hours struggled to handle the busy traffic then. The driving performance for more than 8 hours drives is not ideal, regardless of day or night. The possible factors mentioned above regarding nighttime driving should be considered because drivers who had already driven for 7 hours in the night are recorded with the high number of incidents.

Although temperature and precipitation both have an impact on incidents, temperature’s impact is assumed to be stronger. This is observed from the summary statistics where the majority of numbers for rainfall are all less than the standard for rain (2.5 mm). However, drivers in Melbourne have been more likely to have incidents under heavy rain and high temperature than in Sydney.


# Recommendations

* Utilise tracking technology or system to track every trip so that common driving behaviours and places associated with danger can be spotted. This is suggested for drivers based in populated states - NSW and Melbourne, in response to the high driver incident rates.

* Request feedback from drivers at regular intervals to gather more safety-related information from the trips as traffic is a constantly changing field. Distribute the valuable information so that drivers are of better control over the drives, thereby protecting themselves and the passengers.

* Familiarise drivers with the potential road hazards, especially for the populated area.

* Specifically investigate drivers’ performances in Joondalup, Revesby and Taren Point depots.

* Inspect the factors that influence female drivers’ driving performance, e.g. physical and mental health status, assigned routes and treatment. Discuss with them often to ensure they are capable of taking the assigned shifts.

* Provide extra training for newly joined drivers with less than 10 years of driving experience. Avoid assigning them to routes with high exposure to hazards or peak traffic hours (7-8 am and 3-5 pm on weekdays; 3 pm on weekends) at first. Assign them to depots with a 0% driver incident rate for training, e.g. Pyrmont, Randwick, Capalaba and CATS Perth.

* Regularly check with mid-age and elder drivers to ensure they are mindful of the slight incidents.

* Arrange sufficient breaks for drivers who had driven for 5 hours in the daytime and have shifts in the afternoon. Possibly allocate another driver for the afternoon shift, rather than keeping the same person driving too long.

* Ensure drivers get enough rest before every night drive. Try to adjust the shift timetable so that drivers are unlikely to drive for over 7 hours at night. If the shift lasts longer than 5 hours, assign two drivers so that the other one can take over to avoid the fatigue effect or concentration issues.

* Check the vehicle condition regularly, specifically in hot days and heavy rain to ensure the drivers are in full control of the vehicles, thereby minimising the chance of being affected by these external factors.



# Conclusion

*”Safety first.” - Transdev*

Incidents are prevalent, reducing them is an everyday task. Throughout the analyses, we discover the association of incidents with gender, age, tenure, weather (temperature and precipitation), time and driving hours. The regional differences are also disclosed between depots. Transdev can look into more characteristics in these variables to find out what causes male drivers to incur more incidents while investigating the factors affecting females’ driving performance. Peak hours on weekdays and afternoons on weekends are different, nonetheless, both require drivers’ additional attention. Drivers’ workload should always be considered corresponding to their well-being so as to lower the risks of motor vehicle accidents.

# Appendix
## MVA Incidents
```{r echo=FALSE}
incidents %>%
  filter(grepl('MVA|Motor', ClaimCategoryName)) %>%
  distinct(TypeOfClaimName) %>%
  kable(caption = "List of MVA incidents") %>%
  kable_styling(bootstrap_options = "striped")
```

## Severity Incidents

```{r echo=FALSE}
severity_inc %>%
  filter(severity == "serious") %>%
  distinct(TypeOfClaimName) %>%
  kable(caption = "List of serious incidents") %>%
  kable_styling(bootstrap_options = "striped")
```

## Slight Incidents

```{r echo=FALSE}
severity_inc %>%
  filter(severity == "slight") %>%
  distinct(TypeOfClaimName) %>%
  kable(caption = "List of slight incidents") %>%
  kable_styling(bootstrap_options = "striped")
```

# References

Alboukadel Kassambara (2021). rstatix: Pipe-Friendly Framework for Basic Statistical Tests. R package
  version 0.7.0. https://CRAN.R-project.org/package=rstatix

Aleksandra Paluszynska, Przemyslaw Biecek and Yue Jiang (2020). randomForestExplainer: Explaining and Visualizing Random Forests in Terms of Variable Importance. R package version 0.10.1. https://CRAN.R-project.org/package=randomForestExplainer

A. Liaw and M. Wiener (2002). Classification and Regression by randomForest. R News 2(3), 18--22.

Bentama, A., Khatory, A., & Millot, M. (2017). Spatial analysis of bus accidents in France. *2017 International Colloquium on Logistics and Supply Chain Management (LOGISTIQUA)*. 124-128. 
https://doi.org/10.1109/LOGISTIQUA.2017.7962885

Bhalla, D. (n.d.). *A complete guide to random forest in R*. Listen Data. https://www.listendata.com/2014/11/random-forest-with-r.html

Bob Rudis (2020). hrbrthemes: Additional Themes, Theme Components and Utilities for 'ggplot2'. R package version 0.8.0. https://CRAN.R-project.org/package=hrbrthemes

Claus O. Wilke (2021). ggridges: Ridgeline Plots in 'ggplot2'. R package version 0.5.3. https://CRAN.R-project.org/package=ggridges
  
C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC Florida, 2020.

David Robinson, Alex Hayes and Simon Couch (2021). broom: Convert Statistical Objects into Tidy Tibbles. R package version 0.7.5. https://CRAN.R-project.org/package=broom

Dietrich J (2020). _citation: Software Citation Tools_. R package version 0.4.1.

Garrett Grolemund, Hadley Wickham (2011). Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1-25. URL https://www.jstatsoft.org/v40/i03/.

Goh, K. C. K., Currie, G., Sarvi, M., & Logan, D. (2014). Bus accident analysis of routes with/without bus priority. *Accident Analysis & Prevention. 65*, 18-27. 
https://doi.org/10.1016/j.aap.2013.12.002

Hao Zhu (2021). kableExtra: Construct Complex Table with 'kable' and Pipe Syntax. R package version 1.3.4. https://CRAN.R-project.org/package=kableExtra

Hughes, C. (2020). *Fatalities involving buses Australia 2010-2019*. Statista. https://www.statista.com/statistics/1076120/australia-bus-fatalities/

IBISWorld. (2020, October). *Public Transport in Australia - Market Research Report*. https://www.ibisworld.com/au/industry/public-transport/1965/

Julia Silge, Fanny Chow, Max Kuhn and Hadley Wickham (2021). rsample: General Resampling Infrastructure. R package version 0.0.9. https://CRAN.R-project.org/package=rsample

Keall, M. D., Frith, W. J., & Patterson, T. L. (2005). The contribution of alcohol to night time crash risk and other risks of night driving. *Accident Analysis & Prevention. 37*(5), 816-824.
https://doi.org/10.1016/j.aap.2005.03.021.
 
Law, T. H., Daud, M. S., Hamid, H., & Haron, N. A. (2017). Development of safety performance index for intercity buses: An exploratory factor analysis approach. *Transport Policy. 58*, 46-52. https://doi.org/10.1016/j.tranpol.2017.05.003

Mackie, B. (2008). The benefits of riding the bus. *British Columbia Medical Journal. 50*(9), 490.
https://bcmj.org/presidents-comment/benefits-riding-bus
 
Max Kuhn and Davis Vaughan (2021). parsnip: A Common API to Modeling and Analysis Functions. R package version 0.1.5. https://CRAN.R-project.org/package=parsnip 
 
Max Kuhn (2020). caret: Classification and Regression Training. R package version 6.0-86. https://CRAN.R-project.org/package=caret 
 
Pearce, T., & Maunder, D. (2000). *The causes of bus accidents in five emerging nations*. Transport Research Laboratory. 
http://transport-links.com/wp-content/uploads/2019/11/1_549_PA3574-.pdf
 
Porcu, F., Olivo, A., Maternini, G., & Barabino, B. (2020). Evaluating bus accident risks in public transport. *Transportation Research Procedia. 45*, 443-450. 
https://doi.org/10.1016/j.trpro.2020.03.037

Sadot, S. L. (2019). Can public transportation reduce accidents? Evidence from the introduction of late-night buses in Israeli cities. *Regional Science and Urban Economics. 74*, 99-117.
https://doi.org/10.1016/j.regsciurbeco.2018.11.009
 
Samerei, S. A., Aghabayk, K., Mohammadi, A., & Shiwakoti, N. (2021). Data mining approach to model bus crash severity in Australia. *Journal of Safety Research. 76*. 73-82. https://doi.org/10.1016/j.jsr.2020.12.004

Titos, G., Lyamani, H., Drinovec, L., Olmo, F.J., Močnik, G., & Alados-Arboledas, L. (2015). Evaluation of the impact of transportation changes on air quality. *Atmospheric Environment. 114*, 19-31.
https://doi.org/10.1016/j.atmosenv.2015.05.027
 
Truong, L. T., & Currie, G. (2019). Macroscopic road safety impacts of public transport: A case study of Melbourne, Australia. *Accident Analysis & Prevention, 132*(105270). 
https://doi.org/10.1016/j.aap.2019.105270

Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686

Wikipedia. (n.d.). *Rain. Wikipedia*. https://en.wikipedia.org/wiki/Rain  

